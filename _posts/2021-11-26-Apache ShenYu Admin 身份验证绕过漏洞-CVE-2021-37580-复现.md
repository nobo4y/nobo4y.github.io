---
title: CS免杀-cna   --layer
layout: mypost
categories: [木马免杀]
---    

## 前言

Apache ShenYu Admin 存在身份验证绕过漏洞。 ShenyuAdminBootstrap 中 JWT 的错误使用允许攻击者绕过身份验证，攻击者可通过该漏洞直接进入系统后台。  <!--主要是阐述存在的问题，将问题描述清楚，可适当引出解决方案-->

## 复现详情

影响版本：

Apache ShenYu 2.3.0
Apache ShenYu 2.4.0

分析源代码，可知JWT登录时未校验key，而只校验userName，所以，当伪造的X-Access-Token头中，JWT包含userName即可实现身份验证绕过

jwt登录具体实现在 - org.apache.shenyu.admin.shiro.bean.StatelessAuthFilter：

![1637725491(1)](1637725491(1).jpg)

![1637725721(1)](1637725721(1).png)

未校验key，只验证userName：

![1637725855(1)](1637725855(1).png)

靶场复现：

通过 http://vulfocus.fofa.so/ 进行测试，

启动漏洞环境，抓取数据包，添加伪造的X-Access-Token头：![1637723364(1)](1637723364(1).png)


JWT编码地址：[JWT Token在线编码生成 - ToolTT在线工具箱](https://tooltt.com/jwt-encode/)

![1637723594(1)](1637723594(1).png)

---
