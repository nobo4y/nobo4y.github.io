---
title: APP测试小tips-DNS劫持  --layer
layout: mypost
categories: [APP]
---

## 前言

 在进行app测试时，时常会遇到无法抓取数据包的情况，针对该情况可尝试DNS劫持app抓取数据包进行测试。

环境需求

1.DNSChef.一个高度可配置的DNS代理，可以使用一个DNS代理伪造被劫持域名请求至本机

2.被劫持的域名和真实ip

## 实现

### 1.Burp设置

代理设置中增加本地监听，增加80，443端口，并勾选Invisible。

![](image-20210816194211224.png)

添加域名解析（被劫持的网站域名以及对应的公网真实IP）

![image-20210816194625193](image-20210816194625193.png)

### 2.DNSChef代理设置

更改dnschef.ini配置文件

添加域名劫持，指向局域网内的本机ip，与burp一致

![image-20210816194834644](image-20210816194834644.png)

### 3.更改本机dns设置

将dns地址更改为本身

![image-20210816195119615](image-20210816195119615.png)

刷新本机dns缓存

//**ipconfig  /flushdns**

![image-20210816195333375](image-20210816195333375.png)

运行代理即可

**dnschef.exe --file dnschef.ini**

![image-20210816195634891](image-20210816195634891.png)

可通过ping目标域名可判断是否完成劫持

如下,通过测试所指向本机

![image-20210816195832817](image-20210816195832817.png)

后续正常模拟器或测试机配置代理抓包测试即可













---



